<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Quiz 1: Cybersecurity Basics</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <script>
        const totalQuestions = 10;
        const correctAnswerIndices = [1,1,1,1,1,1,1,1,1,1]; // correct options for each question

        // Update progress bar dynamically
        function updateProgressBar() {
            let correctAnswers = 0;
            for (let i = 1; i <= totalQuestions; i++) {
                const selectedOption = document.querySelector(`input[name="q${i}"]:checked`);
                if (selectedOption && parseInt(selectedOption.value) === correctAnswerIndices[i-1]) {
                    correctAnswers++;
                }
            }
            const progressPercentage = (correctAnswers / totalQuestions) * 100;
            const progressBar = document.getElementById('progressBar');
            progressBar.style.width = progressPercentage + '%';
            progressBar.setAttribute('aria-valuenow', progressPercentage);
            progressBar.textContent = Math.round(progressPercentage) + '%';

            // Optional: change color if 100%
            if (progressPercentage === 100) {
                progressBar.classList.add('bg-success');
            } else {
                progressBar.classList.remove('bg-success');
            }
        }

        // Submit quiz and send to backend only if 100%
        function submitQuiz() {
            let correctAnswers = 0;
            for (let i = 1; i <= totalQuestions; i++) {
                const selectedOption = document.querySelector(`input[name="q${i}"]:checked`);
                if (selectedOption && parseInt(selectedOption.value) === correctAnswerIndices[i-1]) {
                    correctAnswers++;
                }
            }

            if (correctAnswers < totalQuestions) {
                alert("You must answer all questions correctly before submitting!");
                return;
            }

            // Store progress in localStorage
            localStorage.setItem('quiz1Progress', 100);

            // Prepare progress data for backend
            const progress = {
                student: { id: 1 }, // replace with real student ID
                quiz: { id: 1 },    // replace with real quiz ID
                totalQuestions,
                correctAnswers,
                completed: true
            };

            fetch('/api/quiz-progress/complete', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(progress)
            })
                .then(response => response.json())
                .then(data => {
                    alert(`Quiz submitted successfully! Your score: ${correctAnswers}/${totalQuestions}`);
                    window.location.href = 'quiz.html'; // go back to quiz selection
                })
                .catch(error => {
                    console.error('Error:', error);
                    alert("An error occurred while submitting the quiz.");
                });
        }

        // Attach dynamic progress update on radio button change
        document.addEventListener('DOMContentLoaded', () => {
            document.querySelectorAll('input[type="radio"]').forEach(radio => {
                radio.addEventListener('change', updateProgressBar);
            });
            updateProgressBar(); // initialize progress bar
        });
    </script>
</head>
<body class="bg-light">
<div class="container mt-5">
    <h2>Quiz 1: Cybersecurity Basics</h2>

    <!-- Progress Bar -->
    <div class="progress mb-3">
        <div class="progress-bar" role="progressbar" id="progressBar" style="width: 0%;" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100">0%</div>
    </div>

    <form id="quizForm">
        <!-- Questions -->
        <div class="mb-3">
            <h6>1. What does 'phishing' refer to?</h6>
            <div><input type="radio" id="q1a1" name="q1" value="1"><label for="q1a1">An email scam</label></div>
            <div><input type="radio" id="q1a2" name="q1" value="2"><label for="q1a2">A computer virus</label></div>
            <div><input type="radio" id="q1a3" name="q1" value="3"><label for="q1a3">A strong password</label></div>
            <div><input type="radio" id="q1a4" name="q1" value="4"><label for="q1a4">Physical security</label></div>
        </div>
        <div class="mb-3">
            <h6>2. What is a firewall?</h6>
            <div><input type="radio" id="q2a1" name="q2" value="1"><label for="q2a1">A software tool to prevent unauthorized access</label></div>
            <div><input type="radio" id="q2a2" name="q2" value="2"><label for="q2a2">A type of malware</label></div>
            <div><input type="radio" id="q2a3" name="q2" value="3"><label for="q2a3">A hacking technique</label></div>
            <div><input type="radio" id="q2a4" name="q2" value="4"><label for="q2a4">An encryption method</label></div>
        </div>
        <div class="mb-3">
            <h6>3. What does HTTPS stand for?</h6>
            <div><input type="radio" id="q3a1" name="q3" value="1"><label for="q3a1">HyperText Transfer Protocol Secure</label></div>
            <div><input type="radio" id="q3a2" name="q3" value="2"><label for="q3a2">HyperText Transfer Protocol Standard</label></div>
            <div><input type="radio" id="q3a3" name="q3" value="3"><label for="q3a3">Hyper Transfer Text Protocol Secure</label></div>
            <div><input type="radio" id="q3a4" name="q3" value="4"><label for="q3a4">Hyper Transfer Text Protocol Standard</label></div>
        </div>
        <div class="mb-3">
            <h6>4. Which is a common security measure?</h6>
            <div><input type="radio" id="q4a1" name="q4" value="1"><label for="q4a1">Using strong passwords</label></div>
            <div><input type="radio" id="q4a2" name="q4" value="2"><label for="q4a2">Using '123456'</label></div>
            <div><input type="radio" id="q4a3" name="q4" value="3"><label for="q4a3">Sharing passwords with friends</label></div>
            <div><input type="radio" id="q4a4" name="q4" value="4"><label for="q4a4">Ignoring updates</label></div>
        </div>
        <div class="mb-3">
            <h6>5. What is malware?</h6>
            <div><input type="radio" id="q5a1" name="q5" value="1"><label for="q5a1">Malicious software designed to harm</label></div>
            <div><input type="radio" id="q5a2" name="q5" value="2"><label for="q5a2">A type of network tool</label></div>
            <div><input type="radio" id="q5a3" name="q5" value="3"><label for="q5a3">A firewall feature</label></div>
            <div><input type="radio" id="q5a4" name="q5" value="4"><label for="q5a4">An encryption algorithm</label></div>
        </div>
        <div class="mb-3">
            <h6>6. What should you check before clicking a link?</h6>
            <div><input type="radio" id="q6a1" name="q6" value="1"><label for="q6a1">The URL</label></div>
            <div><input type="radio" id="q6a2" name="q6" value="2"><label for="q6a2">Your email</label></div>
            <div><input type="radio" id="q6a3" name="q6" value="3"><label for="q6a3">Other peopleâ€™s emails</label></div>
            <div><input type="radio" id="q6a4" name="q6" value="4"><label for="q6a4">Your calendar</label></div>
        </div>
        <div class="mb-3">
            <h6>7. What is two-factor authentication?</h6>
            <div><input type="radio" id="q7a1" name="q7" value="1"><label for="q7a1">Two methods of verifying identity</label></div>
            <div><input type="radio" id="q7a2" name="q7" value="2"><label for="q7a2">A way to hack someone's account</label></div>
            <div><input type="radio" id="q7a3" name="q7" value="3"><label for="q7a3">A type of password</label></div>
            <div><input type="radio" id="q7a4" name="q7" value="4"><label for="q7a4">An encryption method</label></div>
        </div>
        <div class="mb-3">
            <h6>8. What is a VPN?</h6>
            <div><input type="radio" id="q8a1" name="q8" value="1"><label for="q8a1">Virtual Private Network</label></div>
            <div><input type="radio" id="q8a2" name="q8" value="2"><label for="q8a2">Very Private Network</label></div>
            <div><input type="radio" id="q8a3" name="q8" value="3"><label for="q8a3">Virus Protection Network</label></div>
            <div><input type="radio" id="q8a4" name="q8" value="4"><label for="q8a4">Virtual Protocol Network</label></div>
        </div>
        <div class="mb-3">
            <h6>9. Which of these is a strong password?</h6>
            <div><input type="radio" id="q9a1" name="q9" value="1"><label for="q9a1">P@ssw0rd!</label></div>
            <div><input type="radio" id="q9a2" name="q9" value="2"><label for="q9a2">password123</label></div>
            <div><input type="radio" id="q9a3" name="q9" value="3"><label for="q9a3">12345678</label></div>
            <div><input type="radio" id="q9a4" name="q9" value="4"><label for="q9a4">abcdefg</label></div>
        </div>
        <div class="mb-3">
            <h6>10. What does 'social engineering' mean?</h6>
            <div><input type="radio" id="q10a1" name="q10" value="1"><label for="q10a1">Manipulating people to divulge information</label></div>
            <div><input type="radio" id="q10a2" name="q10" value="2"><label for="q10a2">A design methodology</label></div>
            <div><input type="radio" id="q10a3" name="q10" value="3"><label for="q10a3">A software type</label></div>
            <div><input type="radio" id="q10a4" name="q10" value="4"><label for="q10a4">A kind of engineering job</label></div>
        </div>

        <button type="button" class="btn btn-primary" onclick="submitQuiz()">Submit</button>
    </form>

    <!-- Return Button -->
    <div class="mt-3">
        <button class="btn btn-secondary" onclick="window.location.href='quiz.html'">Return to Quiz Selection</button>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
