<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Quiz 2: Network Security</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <script>
        const totalQuestions = 10;
        const correctAnswerIndices = [1,1,1,1,1,1,1,1,1,1]; // correct options for each question (update as needed)

        // Update progress bar dynamically
        function updateProgressBar() {
            let correctAnswers = 0;
            for (let i = 1; i <= totalQuestions; i++) {
                const selectedOption = document.querySelector(`input[name="q${i}"]:checked`);
                if (selectedOption && parseInt(selectedOption.value) === correctAnswerIndices[i-1]) {
                    correctAnswers++;
                }
            }
            const progressPercentage = (correctAnswers / totalQuestions) * 100;
            const progressBar = document.getElementById('progressBar');
            progressBar.style.width = progressPercentage + '%';
            progressBar.setAttribute('aria-valuenow', progressPercentage);
            progressBar.textContent = Math.round(progressPercentage) + '%';

            if (progressPercentage === 100) {
                progressBar.classList.add('bg-success');
            } else {
                progressBar.classList.remove('bg-success');
            }
        }

        // Submit quiz only if all correct
        function submitQuiz() {
            let correctAnswers = 0;
            for (let i = 1; i <= totalQuestions; i++) {
                const selectedOption = document.querySelector(`input[name="q${i}"]:checked`);
                if (selectedOption && parseInt(selectedOption.value) === correctAnswerIndices[i-1]) {
                    correctAnswers++;
                }
            }

            if (correctAnswers < totalQuestions) {
                alert("You must answer all questions correctly before submitting!");
                return;
            }

            // Store progress in localStorage
            localStorage.setItem('quiz2Progress', 100);

            // Prepare progress data for backend
            const progress = {
                student: { id: 1 }, // replace with real student ID
                quiz: { id: 2 },    // Quiz 2 ID
                totalQuestions,
                correctAnswers,
                completed: true
            };

            fetch('/api/quiz-progress/complete', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(progress)
            })
                .then(response => response.json())
                .then(data => {
                    alert(`Quiz submitted successfully! Your score: ${correctAnswers}/${totalQuestions}`);
                    window.location.href = 'quiz.html';
                })
                .catch(error => {
                    console.error('Error:', error);
                    alert("An error occurred while submitting the quiz.");
                });
        }

        document.addEventListener('DOMContentLoaded', () => {
            document.querySelectorAll('input[type="radio"]').forEach(radio => {
                radio.addEventListener('change', updateProgressBar);
            });
            updateProgressBar();
        });
    </script>
</head>
<body class="bg-light">
<div class="container mt-5">
    <h2>Quiz 2: Network Security</h2>

    <div class="progress mb-3">
        <div class="progress-bar" role="progressbar" id="progressBar" style="width: 0%;" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100">0%</div>
    </div>

    <form id="quizForm">
        <!-- Questions -->
        <div class="mb-3">
            <h6>1. What is the primary purpose of a firewall?</h6>
            <div><input type="radio" id="q1a1" name="q1" value="1"><label for="q1a1">To block unauthorized network traffic</label></div>
            <div><input type="radio" id="q1a2" name="q1" value="2"><label for="q1a2">To scan for viruses on a computer</label></div>
            <div><input type="radio" id="q1a3" name="q1" value="3"><label for="q1a3">To encrypt email messages</label></div>
            <div><input type="radio" id="q1a4" name="q1" value="4"><label for="q1a4">To create VPN tunnels</label></div>
        </div>

        <div class="mb-3">
            <h6>2. What does a VPN do?</h6>
            <div><input type="radio" id="q2a1" name="q2" value="1"><label for="q2a1">Encrypts internet traffic and hides IP address</label></div>
            <div><input type="radio" id="q2a2" name="q2" value="2"><label for="q2a2">Prevents all malware infections</label></div>
            <div><input type="radio" id="q2a3" name="q2" value="3"><label for="q2a3">Acts as a firewall</label></div>
            <div><input type="radio" id="q2a4" name="q2" value="4"><label for="q2a4">Monitors network speed</label></div>
        </div>

        <div class="mb-3">
            <h6>3. Which protocol is used to send emails securely?</h6>
            <div><input type="radio" id="q3a1" name="q3" value="1"><label for="q3a1">SMTP over TLS/SSL</label></div>
            <div><input type="radio" id="q3a2" name="q3" value="2"><label for="q3a2">HTTP</label></div>
            <div><input type="radio" id="q3a3" name="q3" value="3"><label for="q3a3">FTP</label></div>
            <div><input type="radio" id="q3a4" name="q3" value="4"><label for="q3a4">DNS</label></div>
        </div>

        <div class="mb-3">
            <h6>4. What is a DMZ in network security?</h6>
            <div><input type="radio" id="q4a1" name="q4" value="1"><label for="q4a1">A subnet for public-facing servers</label></div>
            <div><input type="radio" id="q4a2" name="q4" value="2"><label for="q4a2">A secure VPN endpoint</label></div>
            <div><input type="radio" id="q4a3" name="q4" value="3"><label for="q4a3">A firewall configuration type</label></div>
            <div><input type="radio" id="q4a4" name="q4" value="4"><label for="q4a4">A type of malware</label></div>
        </div>

        <div class="mb-3">
            <h6>5. Which port does HTTPS use by default?</h6>
            <div><input type="radio" id="q5a1" name="q5" value="1"><label for="q5a1">443</label></div>
            <div><input type="radio" id="q5a2" name="q5" value="2"><label for="q5a2">80</label></div>
            <div><input type="radio" id="q5a3" name="q5" value="3"><label for="q5a3">22</label></div>
            <div><input type="radio" id="q5a4" name="q5" value="4"><label for="q5a4">25</label></div>
        </div>

        <div class="mb-3">
            <h6>6. What does NAT stand for?</h6>
            <div><input type="radio" id="q6a1" name="q6" value="1"><label for="q6a1">Network Address Translation</label></div>
            <div><input type="radio" id="q6a2" name="q6" value="2"><label for="q6a2">Network Authentication Token</label></div>
            <div><input type="radio" id="q6a3" name="q6" value="3"><label for="q6a3">Network Access Terminal</label></div>
            <div><input type="radio" id="q6a4" name="q6" value="4"><label for="q6a4">Network Allocation Table</label></div>
        </div>

        <div class="mb-3">
            <h6>7. What is the function of a router?</h6>
            <div><input type="radio" id="q7a1" name="q7" value="1"><label for="q7a1">Directs network traffic between networks</label></div>
            <div><input type="radio" id="q7a2" name="q7" value="2"><label for="q7a2">Scans for viruses</label></div>
            <div><input type="radio" id="q7a3" name="q7" value="3"><label for="q7a3">Encrypts data</label></div>
            <div><input type="radio" id="q7a4" name="q7" value="4"><label for="q7a4">Creates a VPN connection</label></div>
        </div>

        <div class="mb-3">
            <h6>8. What protocol is used to securely transfer files?</h6>
            <div><input type="radio" id="q8a1" name="q8" value="1"><label for="q8a1">SFTP</label></div>
            <div><input type="radio" id="q8a2" name="q8" value="2"><label for="q8a2">HTTP</label></div>
            <div><input type="radio" id="q8a3" name="q8" value="3"><label for="q8a3">SMTP</label></div>
            <div><input type="radio" id="q8a4" name="q8" value="4"><label for="q8a4">FTP without encryption</label></div>
        </div>

        <div class="mb-3">
            <h6>9. Which is a secure wireless encryption protocol?</h6>
            <div><input type="radio" id="q9a1" name="q9" value="1"><label for="q9a1">WPA3</label></div>
            <div><input type="radio" id="q9a2" name="q9" value="2"><label for="q9a2">WEP</label></div>
            <div><input type="radio" id="q9a3" name="q9" value="3"><label for="q9a3">HTTP</label></div>
            <div><input type="radio" id="q9a4" name="q9" value="4"><label for="q9a4">FTP</label></div>
        </div>

        <div class="mb-3">
            <h6>10. Which protocol resolves domain names to IP addresses?</h6>
            <div><input type="radio" id="q10a1" name="q10" value="1"><label for="q10a1">DNS</label></div>
            <div><input type="radio" id="q10a2" name="q10" value="2"><label for="q10a2">HTTP</label></div>
            <div><input type="radio" id="q10a3" name="q10" value="3"><label for="q10a3">SMTP</label></div>
            <div><input type="radio" id="q10a4" name="q10" value="4"><label for="q10a4">VPN</label></div>
        </div>

        <button type="button" class="btn btn-primary" onclick="submitQuiz()">Submit</button>
    </form>

    <div class="mt-3">
        <button class="btn btn-secondary" onclick="window.location.href='quiz.html'">Return to Quiz Selection</button>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
